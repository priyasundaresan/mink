<mujoco model="pandaomron">
  <compiler angle="radian" meshdir="assets/"/>
  <option timestep="0.002" integrator="implicitfast" gravity="0 0 -9.81"/>

  <!-- Default Configurations -->
  <default>
    <!-- Visual Configurations -->
    <default class="visual">
      <geom type="mesh" contype="0" conaffinity="0" group="2" rgba="0.8 0.8 0.8 1"/>
    </default>
    <!-- Collision Configurations -->
    <default class="collision">
      <geom type="mesh" group="3" rgba="0.6 0.6 0.6 1"/>
    </default>
  </default>

  <!-- Assets -->
  <asset>
    <!-- Omron Base Assets -->
    <mesh file="omron_mobile_base/omron_0.obj" name="omron_0_vis"/>
    <mesh file="omron_mobile_base/omron_1.obj" name="omron_1_vis"/>
    <mesh file="omron_mobile_base/omron_2.obj" name="omron_2_vis"/>
    <mesh file="omron_mobile_base/omron_3.obj" name="omron_3_vis"/>
    <mesh file="omron_mobile_base/omron_4.obj" name="omron_4_vis"/>
    <mesh file="omron_mobile_base/omron_5.obj" name="omron_5_vis"/>
    <mesh file="omron_mobile_base/omron_6.obj" name="omron_6_vis"/>
    <mesh file="omron_mobile_base/omron_7.obj" name="omron_7_vis"/>
    <material name="omron_material" rgba="0.5 0.5 0.5 1"/>

    <!-- Panda Arm Assets -->
    <mesh name="link0" file="panda/link0.stl"/>
    <mesh name="link1" file="panda/link1.stl"/>
    <mesh name="link2" file="panda/link2.stl"/>
    <mesh name="link3" file="panda/link3.stl"/>
    <mesh name="link4" file="panda/link4.stl"/>
    <mesh name="link5" file="panda/link5.stl"/>
    <mesh name="link6" file="panda/link6.stl"/>
    <mesh name="link7" file="panda/link7.stl"/>
    <material name="panda_material" rgba="0.7 0.7 0.7 1"/>

    <!-- Panda Gripper Assets -->
    <mesh name="hand" file="panda_gripper/hand.stl"/>
    <mesh name="finger" file="panda_gripper/finger.stl"/>
    <mesh name="finger_vis" file="panda_gripper/finger_vis.stl"/>
    <material name="gripper_material" rgba="0.6 0.6 0.6 1"/>
  </asset>

  <!-- World -->
  <worldbody>
    <!-- Omron Base -->
    <body name="omron_base" pos="0 0 0.192">
      <geom class="visual" mesh="omron_0_vis"/>
      <geom class="visual" mesh="omron_1_vis"/>
      <geom class="visual" mesh="omron_2_vis"/>
      <joint name="omron_x" type="slide" axis="1 0 0"/>
      <joint name="omron_y" type="slide" axis="0 1 0"/>
      <joint name="omron_yaw" type="hinge" axis="0 0 1"/>

      <!-- Panda Arm -->
      <body name="panda_base" pos="0 0 0.34">
        <geom class="visual" mesh="link0"/>
        <joint name="joint1" type="hinge" axis="0 0 1" range="-2.8973 2.8973"/>

        <body name="panda_link1" pos="0 0 0.333">
          <geom class="visual" mesh="link1"/>
          <joint name="joint2" type="hinge" axis="0 1 0" range="-1.7628 1.7628"/>

          <body name="panda_link2" pos="0 0 0">
            <geom class="visual" mesh="link2"/>
            <joint name="joint3" type="hinge" axis="0 0 1" range="-2.8973 2.8973"/>

            <body name="panda_link3" pos="0 -0.316 0">
              <geom class="visual" mesh="link3"/>
              <joint name="joint4" type="hinge" axis="0 1 0" range="-3.0718 -0.0698"/>

              <body name="panda_link4" pos="0.0825 0 0">
                <geom class="visual" mesh="link4"/>
                <joint name="joint5" type="hinge" axis="0 0 1" range="-2.8973 2.8973"/>

                <body name="panda_link5" pos="-0.0825 0.384 0">
                  <geom class="visual" mesh="link5"/>
                  <joint name="joint6" type="hinge" axis="0 1 0" range="-0.0175 3.7525"/>

                  <body name="panda_link6" pos="0 0 0">
                    <geom class="visual" mesh="link6"/>
                    <joint name="joint7" type="hinge" axis="0 0 1" range="-2.8973 2.8973"/>

                    <!-- Gripper -->
                    <body name="panda_gripper" pos="0 0 0.1">
                      <geom class="visual" mesh="hand"/>

                      <!-- Left Finger -->
                      <body name="left_finger" pos="0.04 0 0">
                        <joint name="finger_joint1" type="slide" axis="1 0 0" range="0 0.04"/>
                        <geom class="visual" mesh="finger"/>
                      </body>

                      <!-- Right Finger -->
                      <body name="right_finger" pos="-0.04 0 0">
                        <joint name="finger_joint2" type="slide" axis="1 0 0" range="-0.04 0"/>
                        <geom class="visual" mesh="finger"/>
                      </body>
                    </body>
                  </body>
                </body>
              </body>
            </body>
          </body>
        </body>
      </body>
    </body>
  </worldbody>

  <!-- Actuators -->
  <actuator>
    <!-- Omron Base Actuators -->
    <velocity joint="omron_x" name="omron_x" ctrlrange="-1 1"/>
    <velocity joint="omron_y" name="omron_y" ctrlrange="-1 1"/>
    <velocity joint="omron_yaw" name="omron_yaw" ctrlrange="-1.5 1.5"/>

    <!-- Panda Arm Actuators -->
    <motor joint="joint1" name="joint1" ctrlrange="-80 80"/>
    <motor joint="joint2" name="joint2" ctrlrange="-80 80"/>
    <motor joint="joint3" name="joint3" ctrlrange="-80 80"/>
    <motor joint="joint4" name="joint4" ctrlrange="-80 80"/>
    <motor joint="joint5" name="joint5" ctrlrange="-80 80"/>
    <motor joint="joint6" name="joint6" ctrlrange="-12 12"/>
    <motor joint="joint7" name="joint7" ctrlrange="-12 12"/>

    <!-- Gripper Actuators -->
    <position joint="finger_joint1" name="gripper_left" ctrlrange="0 0.04"/>
    <position joint="finger_joint2" name="gripper_right" ctrlrange="-0.04 0"/>
  </actuator>


  <keyframe>
    <!-- Home position: base at origin, arm in standard ready pose -->
    <key name="home" 
         qpos="0 0 0 0 -0.785 0 -2.356 0 1.571 0.785 0 0"
         ctrl="0 0 0 0 -0.785 0 -2.356 0 1.571 0.785 0 0"/>
  
    <!-- Retract position: base stationary, arm fully retracted -->
    <key name="retract" 
         qpos="0 0 0 -0.5 0.5 -0.5 0.5 -0.5 0.5 0 0 0"
         ctrl="0 0 0 -0.5 0.5 -0.5 0.5 -0.5 0.5 0 0 0"/>
  </keyframe>
</mujoco>

